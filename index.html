<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO ë©”íƒ€ íƒœê·¸ -->
    <title>ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ì‹œíŠ¸ | ëŒ€ì¶œ ìƒí™˜ ê³„ì‚°ê¸° | ì›ê¸ˆê· ë“± ì›ë¦¬ê¸ˆê· ë“± ê³„ì‚°</title>
    <meta name="description" content="ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ë„êµ¬ë¡œ ì—¬ëŸ¬ ëŒ€ì¶œì„ í•œëˆˆì— ê´€ë¦¬í•˜ì„¸ìš”. ì›ê¸ˆê· ë“±, ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜ ë°©ì‹ ì§€ì›, ì›” ìƒí™˜ê¸ˆ ìë™ ê³„ì‚°, ìƒí™˜ ìŠ¤ì¼€ì¤„ í™•ì¸ ê°€ëŠ¥. ì‹ ìš©ëŒ€ì¶œ, ë§ˆì´ë„ˆìŠ¤í†µì¥, ë‹´ë³´ëŒ€ì¶œ í†µí•© ê´€ë¦¬.">
    <meta name="keywords" content="ëŒ€ì¶œê´€ë¦¬, ëŒ€ì¶œê³„ì‚°ê¸°, ìƒí™˜ê³„ì‚°ê¸°, ì›ê¸ˆê· ë“±, ì›ë¦¬ê¸ˆê· ë“±, ëŒ€ì¶œìƒí™˜, ì›”ìƒí™˜ê¸ˆê³„ì‚°, ë¬´ë£ŒëŒ€ì¶œê´€ë¦¬, ëŒ€ì¶œí†µí•©ê´€ë¦¬, ì‹ ìš©ëŒ€ì¶œê³„ì‚°ê¸°">
    <meta name="author" content="ì§€ì˜í‚¹">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph íƒœê·¸ (ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ ) -->
    <meta property="og:title" content="ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ì‹œíŠ¸ - ê°„í¸í•œ ëŒ€ì¶œ ìƒí™˜ ê³„ì‚°ê¸°">
    <meta property="og:description" content="ì—¬ëŸ¬ ëŒ€ì¶œì„ í•œëˆˆì— ê´€ë¦¬í•˜ê³  ì›” ìƒí™˜ê¸ˆì„ ìë™ ê³„ì‚°í•˜ëŠ” ë¬´ë£Œ ë„êµ¬. ì›ê¸ˆê· ë“±, ì›ë¦¬ê¸ˆê· ë“± ë°©ì‹ ì§€ì›.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com">
    <meta property="og:image" content="https://your-domain.com/loan-manager-preview.jpg">
    <meta property="og:site_name" content="ëŒ€ì¶œ ê´€ë¦¬ ì‹œíŠ¸">
    <meta property="og:locale" content="ko_KR">
    
    <!-- Twitter ì¹´ë“œ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ì‹œíŠ¸">
    <meta name="twitter:description" content="ì—¬ëŸ¬ ëŒ€ì¶œì„ í•œëˆˆì— ê´€ë¦¬í•˜ê³  ì›” ìƒí™˜ê¸ˆì„ ìë™ ê³„ì‚°í•˜ëŠ” ë¬´ë£Œ ë„êµ¬">
    <meta name="twitter:image" content="https://your-domain.com/loan-manager-preview.jpg">
    
    <!-- êµ¬ì¡°í™”ëœ ë°ì´í„° (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ëŒ€ì¶œ ê´€ë¦¬ ì‹œíŠ¸",
        "description": "ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ë° ìƒí™˜ ê³„ì‚° ë„êµ¬",
        "url": "https://your-domain.com",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "KRW"
        },
        "creator": {
            "@type": "Person",
            "name": "ì§€ì˜í‚¹",
            "url": "https://www.linkedin.com/in/jyking0907/"
        },
        "featureList": [
            "ëŒ€ì¶œ í†µí•© ê´€ë¦¬",
            "ì›” ìƒí™˜ê¸ˆ ìë™ ê³„ì‚°",
            "ì›ê¸ˆê· ë“± ìƒí™˜ ìŠ¤ì¼€ì¤„",
            "ì›ë¦¬ê¸ˆê· ë“± ìƒí™˜ ë°©ì‹ ì§€ì›",
            "ë§ˆì´ë„ˆìŠ¤í†µì¥ ê´€ë¦¬",
            "ìƒí™˜ ì§„í–‰ë¥  ì‹œê°í™”"
        ]
    }
    </script>
    
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- ì–¸ì–´ ì„¤ì • -->
    <meta http-equiv="content-language" content="ko">
    <link rel="alternate" hreflang="ko" href="https://your-domain.com">
    
    <!-- ìºë…¸ë‹ˆì»¬ URL -->
    <link rel="canonical" href="https://your-domain.com">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #FF4F0F;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #FFE3BB;
        }
        
        .dashboard-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 4px solid;
        }
        
        .dashboard-card.total { border-left-color: #FF4F0F; }
        .dashboard-card.monthly { border-left-color: #03A6A1; }
        .dashboard-card.count { border-left-color: #FFA673; }
        .dashboard-card.average { border-left-color: #FF4F0F; }
        
        .dashboard-card h3 {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .dashboard-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 40px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .section-header {
            background: #03A6A1;
            color: white;
            padding: 20px 30px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #555;
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #FF4F0F;
            box-shadow: 0 0 0 3px rgba(255, 79, 15, 0.1);
        }
        
        .btn {
            background: #FF4F0F;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            background: #e6450d;
            transform: translateY(-1px);
        }
        
        .loan-list {
            margin-top: 30px;
        }
        
        .loan-item {
            background: #fff;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .loan-item:hover {
            border-color: #FFA673;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .loan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .loan-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            flex: 1;
        }
        
        .loan-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .loan-type {
            background: #FF4F0F;
            color: white;
            padding: 5px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .minus-account .loan-type {
            background: #FFA673;
        }
        
        .edit-btn {
            background: #03A6A1;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn:hover {
            background: #028a86;
        }
        
        .loan-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .loan-detail {
            text-align: center;
        }
        
        .loan-detail .label {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .loan-detail .value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
        }
        
        .progress-bar {
            background: #e1e5e9;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: #03A6A1;
            transition: width 0.3s ease;
        }

        .minus-account {
            border-left: 4px solid #FFA673;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #333;
            margin: 0;
        }

        .close {
            color: #999;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
        }

        .close:hover {
            color: #FF4F0F;
        }

        .payment-schedule {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
        }

        .schedule-header, .schedule-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #e1e5e9;
        }

        .schedule-header {
            background: #FFE3BB;
            font-weight: bold;
            color: #333;
        }

        .schedule-row:nth-child(even) {
            background: #f9f9f9;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #e1e5e9;
            color: #666;
            font-size: 0.9rem;
        }

        .footer a {
            color: #FF4F0F;
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .content {
                padding: 20px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .loan-details {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .loan-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .loan-controls {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’° ëŒ€ì¶œ ìƒí™˜ ê´€ë¦¬</h1>
            <p>í•œ ëˆˆì— ë³´ëŠ” ë‚˜ì˜ ëŒ€ì¶œ í˜„í™© - ë¬´ë£Œ ëŒ€ì¶œ ê´€ë¦¬ ë„êµ¬</p>
        </div>
        
        <div class="dashboard">
            <div class="dashboard-card total">
                <h3>ì´ ëŒ€ì¶œ ì”ì•¡</h3>
                <div class="value" id="totalBalance">0ì›</div>
            </div>
            <div class="dashboard-card monthly">
                <h3>ì›” ì´ ìƒí™˜ê¸ˆ</h3>
                <div class="value" id="monthlyPayment">0ì›</div>
            </div>
            <div class="dashboard-card count">
                <h3>ëŒ€ì¶œ ê°œìˆ˜</h3>
                <div class="value" id="loanCount">0ê°œ</div>
            </div>
            <div class="dashboard-card average">
                <h3>í‰ê·  ê¸ˆë¦¬</h3>
                <div class="value" id="averageRate">0%</div>
            </div>
        </div>
        
        <div class="content">
            <div class="section">
                <div class="section-header">
                    â• ìƒˆ ëŒ€ì¶œ ì¶”ê°€
                </div>
                <div class="section-content">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="loanName">ëŒ€ì¶œëª…</label>
                            <input type="text" id="loanName" placeholder="ì˜ˆ: KBêµ­ë¯¼ì€í–‰ ì‹ ìš©ëŒ€ì¶œ">
                        </div>
                        <div class="form-group">
                            <label for="loanType">ëŒ€ì¶œ ì¢…ë¥˜</label>
                            <select id="loanType">
                                <option value="ì‹ ìš©ëŒ€ì¶œ">ì‹ ìš©ëŒ€ì¶œ</option>
                                <option value="ë§ˆì´ë„ˆìŠ¤í†µì¥">ë§ˆì´ë„ˆìŠ¤í†µì¥</option>
                                <option value="ë‹´ë³´ëŒ€ì¶œ">ë‹´ë³´ëŒ€ì¶œ</option>
                                <option value="ì „ì„¸ìê¸ˆëŒ€ì¶œ">ì „ì„¸ìê¸ˆëŒ€ì¶œ</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="originalAmount">ì›ê¸ˆ (ì›)</label>
                            <input type="number" id="originalAmount" placeholder="10000000">
                        </div>
                        <div class="form-group">
                            <label for="currentBalance">í˜„ì¬ ì”ì•¡ (ì›)</label>
                            <input type="number" id="currentBalance" placeholder="8000000">
                        </div>
                        <div class="form-group">
                            <label for="interestRate">ì—°ì´ìœ¨ (%)</label>
                            <input type="number" id="interestRate" step="0.1" placeholder="4.5">
                        </div>
                        <div class="form-group">
                            <label for="paymentType">ìƒí™˜ ë°©ì‹</label>
                            <select id="paymentType">
                                <option value="ì›ë¦¬ê¸ˆê· ë“±">ì›ë¦¬ê¸ˆê· ë“±</option>
                                <option value="ì›ê¸ˆê· ë“±">ì›ê¸ˆê· ë“±</option>
                                <option value="ë§Œê¸°ì¼ì‹œìƒí™˜">ë§Œê¸°ì¼ì‹œìƒí™˜</option>
                                <option value="ììœ ìƒí™˜">ììœ ìƒí™˜ (ë§ˆì´ë„ˆìŠ¤í†µì¥)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="monthlyPayment">ì›” ìƒí™˜ê¸ˆ (ì›)</label>
                            <input type="number" id="monthlyPaymentInput" placeholder="200000">
                        </div>
                        <div class="form-group">
                            <label for="maturityDate">ë§Œê¸°ì¼</label>
                            <input type="date" id="maturityDate">
                        </div>
                        <div class="form-group">
                            <label for="paymentDay">ë§¤ì›” ìƒí™˜ì¼</label>
                            <input type="number" id="paymentDay" min="1" max="31" placeholder="15">
                        </div>
                    </div>
                    <button class="btn" onclick="addLoan()">ëŒ€ì¶œ ì¶”ê°€</button>
                </div>
            </div>
            
            <div class="section">
                <div class="section-header">
                    ğŸ“‹ ëŒ€ì¶œ ëª©ë¡
                </div>
                <div class="section-content">
                    <div class="loan-list" id="loanList">
                        <p style="text-align: center; color: #666; padding: 40px;">
                            ì•„ì§ ë“±ë¡ëœ ëŒ€ì¶œì´ ì—†ìŠµë‹ˆë‹¤.<br>
                            ìœ„ì—ì„œ ëŒ€ì¶œ ì •ë³´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ìˆ˜ì • ëª¨ë‹¬ -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ëŒ€ì¶œ ì •ë³´ ìˆ˜ì •</h2>
                    <button class="close" onclick="closeEditModal()">&times;</button>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editLoanName">ëŒ€ì¶œëª…</label>
                        <input type="text" id="editLoanName">
                    </div>
                    <div class="form-group">
                        <label for="editLoanType">ëŒ€ì¶œ ì¢…ë¥˜</label>
                        <select id="editLoanType">
                            <option value="ì‹ ìš©ëŒ€ì¶œ">ì‹ ìš©ëŒ€ì¶œ</option>
                            <option value="ë§ˆì´ë„ˆìŠ¤í†µì¥">ë§ˆì´ë„ˆìŠ¤í†µì¥</option>
                            <option value="ë‹´ë³´ëŒ€ì¶œ">ë‹´ë³´ëŒ€ì¶œ</option>
                            <option value="ì „ì„¸ìê¸ˆëŒ€ì¶œ">ì „ì„¸ìê¸ˆëŒ€ì¶œ</option>
                            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editOriginalAmount">ì›ê¸ˆ (ì›)</label>
                        <input type="number" id="editOriginalAmount">
                    </div>
                    <div class="form-group">
                        <label for="editCurrentBalance">í˜„ì¬ ì”ì•¡ (ì›)</label>
                        <input type="number" id="editCurrentBalance">
                    </div>
                    <div class="form-group">
                        <label for="editInterestRate">ì—°ì´ìœ¨ (%)</label>
                        <input type="number" id="editInterestRate" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editPaymentType">ìƒí™˜ ë°©ì‹</label>
                        <select id="editPaymentType">
                            <option value="ì›ë¦¬ê¸ˆê· ë“±">ì›ë¦¬ê¸ˆê· ë“±</option>
                            <option value="ì›ê¸ˆê· ë“±">ì›ê¸ˆê· ë“±</option>
                            <option value="ë§Œê¸°ì¼ì‹œìƒí™˜">ë§Œê¸°ì¼ì‹œìƒí™˜</option>
                            <option value="ììœ ìƒí™˜">ììœ ìƒí™˜ (ë§ˆì´ë„ˆìŠ¤í†µì¥)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editMonthlyPayment">ì›” ìƒí™˜ê¸ˆ (ì›)</label>
                        <input type="number" id="editMonthlyPayment">
                    </div>
                    <div class="form-group">
                        <label for="editMaturityDate">ë§Œê¸°ì¼</label>
                        <input type="date" id="editMaturityDate">
                    </div>
                    <div class="form-group">
                        <label for="editPaymentDay">ë§¤ì›” ìƒí™˜ì¼</label>
                        <input type="number" id="editPaymentDay" min="1" max="31">
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="updateLoan()">ìˆ˜ì • ì™„ë£Œ</button>
                    <button class="btn" onclick="closeEditModal()" style="background: #666; margin-left: 10px;">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>

        <!-- ìƒí™˜ ìŠ¤ì¼€ì¤„ ëª¨ë‹¬ -->
        <div id="scheduleModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ìƒí™˜ ìŠ¤ì¼€ì¤„</h2>
                    <button class="close" onclick="closeScheduleModal()">&times;</button>
                </div>
                <div id="scheduleContent"></div>
            </div>
        </div>
        
        <div class="footer">
            Made by <a href="https://www.linkedin.com/in/jyking0907/" target="_blank">ì§€ì˜í‚¹</a> with Claude
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let loans = [];
        let currentEditIndex = -1;

        // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬
        function loadLoans() {
            try {
                const savedLoans = localStorage.getItem('loanData');
                loans = savedLoans ? JSON.parse(savedLoans) : [];
            } catch (error) {
                loans = [];
            }
        }

        function saveLoans() {
            try {
                localStorage.setItem('loanData', JSON.stringify(loans));
                return true;
            } catch (error) {
                alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                return false;
            }
        }

        // ìˆ«ì í¬ë§·íŒ…
        function formatNumber(num) {
            if (num === null || num === undefined || isNaN(num)) return '0';
            return new Intl.NumberFormat('ko-KR').format(num);
        }

        // ì›ê¸ˆê· ë“±ìƒí™˜ ì›” ìƒí™˜ê¸ˆ ê³„ì‚°
        function calculateEqualPrincipalPayment(loan) {
            if (!loan.maturityDate || loan.currentBalance <= 0) return 0;
            
            const today = new Date();
            const maturity = new Date(loan.maturityDate);
            const diffTime = maturity - today;
            const remainingMonths = Math.max(1, Math.ceil(diffTime / (1000 * 60 * 60 * 24 * 30.44)));
            
            const monthlyPrincipal = loan.currentBalance / remainingMonths;
            const monthlyInterest = loan.currentBalance * (loan.interestRate / 100 / 12);
            
            return Math.round(monthlyPrincipal + monthlyInterest);
        }

        // ì›” ìƒí™˜ê¸ˆ í‘œì‹œ
        function getMonthlyPaymentDisplay(loan) {
            if (loan.paymentType === 'ì›ê¸ˆê· ë“±') {
                const payment = calculateEqualPrincipalPayment(loan);
                return formatNumber(payment) + ' (ë³€ë™)';
            }
            return formatNumber(loan.monthlyPayment || 0);
        }

        // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDashboard() {
            const totalBalance = loans.reduce((sum, loan) => sum + (loan.currentBalance || 0), 0);
            const monthlyPayment = loans.reduce((sum, loan) => {
                if (loan.paymentType === 'ì›ê¸ˆê· ë“±') {
                    return sum + calculateEqualPrincipalPayment(loan);
                }
                return sum + (loan.monthlyPayment || 0);
            }, 0);
            const loanCount = loans.length;
            const averageRate = loanCount > 0 ? 
                loans.reduce((sum, loan) => sum + (loan.interestRate || 0), 0) / loanCount : 0;

            document.getElementById('totalBalance').textContent = formatNumber(totalBalance) + 'ì›';
            document.getElementById('monthlyPayment').textContent = formatNumber(monthlyPayment) + 'ì›';
            document.getElementById('loanCount').textContent = loanCount + 'ê°œ';
            document.getElementById('averageRate').textContent = averageRate.toFixed(2) + '%';
        }

        // ëŒ€ì¶œ ëª©ë¡ ë Œë”ë§
        function renderLoans() {
            const loanList = document.getElementById('loanList');
            
            if (loans.length === 0) {
                loanList.innerHTML = `
                    <p style="text-align: center; color: #666; padding: 40px;">
                        ì•„ì§ ë“±ë¡ëœ ëŒ€ì¶œì´ ì—†ìŠµë‹ˆë‹¤.<br>
                        ìœ„ì—ì„œ ëŒ€ì¶œ ì •ë³´ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.
                    </p>
                `;
                return;
            }

            loanList.innerHTML = loans.map((loan, index) => {
                const progressPercent = loan.originalAmount > 0 ? 
                    ((loan.originalAmount - loan.currentBalance) / loan.originalAmount * 100) : 0;
                
                const isMinusAccount = loan.loanType === 'ë§ˆì´ë„ˆìŠ¤í†µì¥';
                const minusClass = isMinusAccount ? 'minus-account' : '';
                
                return `
                    <div class="loan-item ${minusClass}">
                        <div class="loan-header">
                            <div class="loan-name">${loan.name || 'ì´ë¦„ ì—†ìŒ'}</div>
                            <div class="loan-controls">
                                <div class="loan-type">${loan.loanType || 'ê¸°íƒ€'}</div>
                                <button class="edit-btn" onclick="editLoan(${index})">ìˆ˜ì •</button>
                            </div>
                        </div>
                        <div class="loan-details">
                            <div class="loan-detail">
                                <div class="label">ì›ê¸ˆ</div>
                                <div class="value">${formatNumber(loan.originalAmount)}ì›</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">í˜„ì¬ ì”ì•¡</div>
                                <div class="value">${formatNumber(loan.currentBalance)}ì›</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">ê¸ˆë¦¬</div>
                                <div class="value">${loan.interestRate || 0}%</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">ì›” ìƒí™˜ê¸ˆ</div>
                                <div class="value">${getMonthlyPaymentDisplay(loan)}ì›</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">ìƒí™˜ ë°©ì‹</div>
                                <div class="value">${loan.paymentType || 'ê¸°íƒ€'}</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">ë§Œê¸°ì¼</div>
                                <div class="value">${loan.maturityDate || '-'}</div>
                            </div>
                            <div class="loan-detail">
                                <div class="label">ë§¤ì›” ìƒí™˜ì¼</div>
                                <div class="value">${loan.paymentDay ? loan.paymentDay + 'ì¼' : '-'}</div>
                            </div>
                        </div>
                        ${!isMinusAccount && loan.paymentType === 'ì›ê¸ˆê· ë“±' ? `
                            <div style="text-align: center; margin-top: 15px;">
                                <button class="btn" onclick="showPaymentSchedule(${index})" style="padding: 8px 16px; font-size: 0.9rem;">
                                    ìƒí™˜ ìŠ¤ì¼€ì¤„ ë³´ê¸°
                                </button>
                            </div>
                        ` : ''}
                        ${!isMinusAccount && loan.paymentType !== 'ì›ê¸ˆê· ë“±' ? `
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <div style="text-align: center; margin-top: 10px; font-size: 0.9rem; color: #666;">
                                ìƒí™˜ ì§„í–‰ë¥ : ${progressPercent.toFixed(1)}%
                            </div>
                        ` : ''}
                        ${isMinusAccount ? `
                            <div style="text-align: center; margin-top: 15px; font-size: 0.9rem; color: #666;">
                                ì‚¬ìš© í•œë„: ${formatNumber(loan.originalAmount)}ì› | 
                                í˜„ì¬ ì‚¬ìš©: ${formatNumber(loan.currentBalance)}ì›
                                ${loan.paymentDay ? ` | ë§¤ì›” ${loan.paymentDay}ì¼ ìƒí™˜` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // ëŒ€ì¶œ ì¶”ê°€
        function addLoan() {
            const name = document.getElementById('loanName').value.trim();
            const loanType = document.getElementById('loanType').value;
            const originalAmount = parseInt(document.getElementById('originalAmount').value) || 0;
            const currentBalance = parseInt(document.getElementById('currentBalance').value) || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
            const paymentType = document.getElementById('paymentType').value;
            const monthlyPayment = parseInt(document.getElementById('monthlyPaymentInput').value) || 0;
            const maturityDate = document.getElementById('maturityDate').value;
            const paymentDay = parseInt(document.getElementById('paymentDay').value) || null;

            if (!name || originalAmount <= 0) {
                alert('ëŒ€ì¶œëª…ê³¼ ì›ê¸ˆì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const loan = {
                id: Date.now(),
                name,
                loanType,
                originalAmount,
                currentBalance,
                interestRate,
                paymentType,
                monthlyPayment,
                maturityDate,
                paymentDay,
                createdAt: new Date().toISOString()
            };

            loans.push(loan);
            
            if (saveLoans()) {
                // í¼ ì´ˆê¸°í™”
                document.getElementById('loanName').value = '';
                document.getElementById('originalAmount').value = '';
                document.getElementById('currentBalance').value = '';
                document.getElementById('interestRate').value = '';
                document.getElementById('monthlyPaymentInput').value = '';
                document.getElementById('maturityDate').value = '';
                document.getElementById('paymentDay').value = '';

                updateDashboard();
                renderLoans();
                alert('ëŒ€ì¶œì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ëŒ€ì¶œ ìˆ˜ì •
        function editLoan(index) {
            if (index < 0 || index >= loans.length) {
                alert('ì˜ëª»ëœ ëŒ€ì¶œ ì •ë³´ì…ë‹ˆë‹¤.');
                return;
            }
            
            currentEditIndex = index;
            const loan = loans[index];
            
            // ìˆ˜ì • í¼ì— ê¸°ì¡´ ë°ì´í„° ì…ë ¥
            document.getElementById('editLoanName').value = loan.name || '';
            document.getElementById('editLoanType').value = loan.loanType || '';
            document.getElementById('editOriginalAmount').value = loan.originalAmount || '';
            document.getElementById('editCurrentBalance').value = loan.currentBalance || '';
            document.getElementById('editInterestRate').value = loan.interestRate || '';
            document.getElementById('editPaymentType').value = loan.paymentType || '';
            document.getElementById('editMonthlyPayment').value = loan.monthlyPayment || '';
            document.getElementById('editMaturityDate').value = loan.maturityDate || '';
            document.getElementById('editPaymentDay').value = loan.paymentDay || '';
            
            document.getElementById('editModal').style.display = 'block';
        }

        function updateLoan() {
            if (currentEditIndex < 0 || currentEditIndex >= loans.length) {
                alert('ì˜ëª»ëœ ëŒ€ì¶œ ì •ë³´ì…ë‹ˆë‹¤.');
                return;
            }
            
            const name = document.getElementById('editLoanName').value.trim();
            const loanType = document.getElementById('editLoanType').value;
            const originalAmount = parseInt(document.getElementById('editOriginalAmount').value) || 0;
            const currentBalance = parseInt(document.getElementById('editCurrentBalance').value) || 0;
            const interestRate = parseFloat(document.getElementById('editInterestRate').value) || 0;
            const paymentType = document.getElementById('editPaymentType').value;
            const monthlyPayment = parseInt(document.getElementById('editMonthlyPayment').value) || 0;
            const maturityDate = document.getElementById('editMaturityDate').value;
            const paymentDay = parseInt(document.getElementById('editPaymentDay').value) || null;

            if (!name || originalAmount <= 0) {
                alert('ëŒ€ì¶œëª…ê³¼ ì›ê¸ˆì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ê¸°ì¡´ ëŒ€ì¶œ ì •ë³´ ì—…ë°ì´íŠ¸
            loans[currentEditIndex] = {
                ...loans[currentEditIndex],
                name,
                loanType,
                originalAmount,
                currentBalance,
                interestRate,
                paymentType,
                monthlyPayment,
                maturityDate,
                paymentDay,
                updatedAt: new Date().toISOString()
            };

            if (saveLoans()) {
                updateDashboard();
                renderLoans();
                closeEditModal();
                alert('ëŒ€ì¶œ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            currentEditIndex = -1;
        }

        // ìƒí™˜ ìŠ¤ì¼€ì¤„ í‘œì‹œ
        function showPaymentSchedule(index) {
            if (index < 0 || index >= loans.length) {
                alert('ì˜ëª»ëœ ëŒ€ì¶œ ì •ë³´ì…ë‹ˆë‹¤.');
                return;
            }
            
            const loan = loans[index];
            if (loan.paymentType !== 'ì›ê¸ˆê· ë“±') {
                alert('ì›ê¸ˆê· ë“± ìƒí™˜ ë°©ì‹ë§Œ ìŠ¤ì¼€ì¤„ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            const scheduleContent = document.getElementById('scheduleContent');
            let html = `
                <div class="payment-schedule">
                    <div class="schedule-header">
                        <div>íšŒì°¨</div>
                        <div>ì›ê¸ˆ</div>
                        <div>ì´ì</div>
                        <div>ì´ ìƒí™˜ì•¡</div>
                    </div>
            `;
            
            const today = new Date();
            const maturity = new Date(loan.maturityDate);
            const diffTime = maturity - today;
            const totalMonths = Math.max(1, Math.ceil(diffTime / (1000 * 60 * 60 * 24 * 30.44)));
            
            const monthlyPrincipal = Math.round(loan.currentBalance / totalMonths);
            let remainingBalance = loan.currentBalance;
            
            for (let i = 1; i <= Math.min(totalMonths, 24); i++) {
                const monthlyInterest = Math.round(remainingBalance * (loan.interestRate / 100 / 12));
                const currentPrincipal = i === totalMonths ? remainingBalance : monthlyPrincipal;
                const totalPayment = currentPrincipal + monthlyInterest;
                
                html += `
                    <div class="schedule-row">
                        <div>${i}íšŒì°¨</div>
                        <div>${formatNumber(currentPrincipal)}ì›</div>
                        <div>${formatNumber(monthlyInterest)}ì›</div>
                        <div>${formatNumber(totalPayment)}ì›</div>
                    </div>
                `;
                
                remainingBalance -= currentPrincipal;
                if (remainingBalance <= 0) break;
            }
            
            if (totalMonths > 24) {
                html += `
                    <div style="text-align: center; padding: 15px; color: #666; font-style: italic;">
                        ... ${totalMonths - 24}ê°œì›” ë” (ì´ ${totalMonths}ê°œì›”)
                    </div>
                `;
            }
            
            html += '</div>';
            scheduleContent.innerHTML = html;
            document.getElementById('scheduleModal').style.display = 'block';
        }

        function closeScheduleModal() {
            document.getElementById('scheduleModal').style.display = 'none';
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            loadLoans();
            updateDashboard();
            renderLoans();

            // ëŒ€ì¶œ ì¢…ë¥˜ì— ë”°ë¥¸ ìƒí™˜ ë°©ì‹ ìë™ ì¡°ì •
            const loanTypeSelect = document.getElementById('loanType');
            const paymentTypeSelect = document.getElementById('paymentType');
            const editLoanTypeSelect = document.getElementById('editLoanType');
            const editPaymentTypeSelect = document.getElementById('editPaymentType');
            
            if (loanTypeSelect && paymentTypeSelect) {
                loanTypeSelect.addEventListener('change', function() {
                    if (this.value === 'ë§ˆì´ë„ˆìŠ¤í†µì¥') {
                        paymentTypeSelect.value = 'ììœ ìƒí™˜';
                    }
                });
            }
            
            if (editLoanTypeSelect && editPaymentTypeSelect) {
                editLoanTypeSelect.addEventListener('change', function() {
                    if (this.value === 'ë§ˆì´ë„ˆìŠ¤í†µì¥') {
                        editPaymentTypeSelect.value = 'ììœ ìƒí™˜';
                    }
                });
            }
        });

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            const editModal = document.getElementById('editModal');
            const scheduleModal = document.getElementById('scheduleModal');
            
            if (event.target === editModal) {
                closeEditModal();
            }
            if (event.target === scheduleModal) {
                closeScheduleModal();
            }
        }
    </script>
</body>
</html>